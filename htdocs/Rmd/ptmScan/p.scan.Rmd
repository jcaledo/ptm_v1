---
title: "Scan a Protein in Search of Phosphosites"
# author: "Juan Carlos Aledo"
# date: "10/25/2019"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
knitr::opts_chunk$set(echo = TRUE)
library(ptm)
```

### Description
Scans the indicated protein in search of phosphosites

### Usage
p.scan(up_id, db = 'all')

### Arguments
_up_id_	a character string corresponding to the UniProt ID.

_db_	the database where to search. It should be one among 'PSP', 'dbPTM', 'dbPAF', 'PhosPhAt', 'Phospho.ELM', 'all'.

### Value
Returns a dataframe where each row corresponds to a phosphorylatable residue.

### References
Hornbeck et al. [Nucleic Acids Res. 2019 47:D433-D441](https://www.ncbi.nlm.nih.gov/pubmed/30445427).
Huang et al. [Nucleic Acids Res. 2019 47:D298-D308](https://www.ncbi.nlm.nih.gov/pubmed/30418626).
Ullah et al. [Sci. Rep. 2016 6:23534](https://www.ncbi.nlm.nih.gov/pubmed/27010073).
Durek et al. [Nucleic Acids Res.2010 38:D828-D834](https://www.ncbi.nlm.nih.gov/pubmed/19880383).
Dinkel et al. [Nucleic Acids Res. 2011 39:D261-D567](https://www.ncbi.nlm.nih.gov/pubmed/21062810).

### See Also
_ac.scan()_, _meto.scan()_, _ni.scan()_, _gl.scan()_, _ub.scan()_, _su.scan()_, _dis.scan()_, _sni.scan()_, _me.scan()_, _ptm.scan()_, _reg.scan()_

### Details

Protein phosphorylation is one of the most important post-translational modifications (PTMs) and regulates a broad spectrum of biological processes. 

Recent progresses in phosphoproteomic identifications have generated a flood of phosphorylation sites. Various curated databases containing known phosphorylation sites have been described and are accessible. 

The package _ptm_ provides a function, **p.scan()**, that aims to integrate information from different phosphorylation site databases, and assist to identify phosphosites in a given protein. The UniProt ID of the protein of interest must be passed as argument. A second argument for this function is _db_, used to indicate the database to be searched. The databases accessible for this purpose are:

* [PSP](https://www.phosphosite.org): PhosphoSitePlus.
* [dbPTM](http://dbptm.mbc.nctu.edu.tw): database of Post-Translational Modifications.
* [dbPAF](http://dbpaf.biocuckoo.org): database of Phosphosites in Animals and Fungi.
* [PhosPhAt](http://phosphat.uni-hohenheim.de/): The Arabidopsis Protein Phosphorylation Site Database.
* [Phospho.ELM](http://phospho.elm.eu.org/index.html): a database of S/T/Y phosphorylation sites.

By default, **p.scan()** use all above databases to search for phosphosites. It should be noted that the number of phosphosites recovered for a protein may depend on the database consulted. For instance, let's suppose we are interested in the protein alfa-1-antitrypsin (P01009). If we search in dbPTM or dbPFA we will recover the same 7 phosphosites:

```{r}
mydbPTM <- p.scan('P01009', db = 'dbPTM')$modification
mydbPTM
```

```{r}
mydbPAF <- p.scan('P01009', db = 'dbPAF')$modification
mydbPAF
```

However, if we carry out the query using PhosphoSitePlus:

```{r}
myPSP <- p.scan('P01009', db = 'PSP')$modification
intersect(myPSP, mydbPTM)
```

We get the same 7 phophosphosite that we already knewy and 8 additional phosphosites, which were not present in dbPTM nor dbPFA.

```{r}
setdiff(myPSP, mydbPTM)
```

Thus, if we want the most comprehensive results, the best option is set _db = 'all'_:
```{r}
unique(p.scan('P01009', db = 'all')$modification)
```

Nevertheless, it is worth remembering that not always 'more is better'. To this respect, mass spectrometric methods are revealing a very large number of protein phosphorylation sites in cells. However, do each of these phosphorylations have a role in the functioning of a cellular process? We do not know the answer to this question because the functional effects of the vast majority of these phosphorylations have not yet been investigated. However, there are reasons for believing that some portion of these reported phosphorylations might have [little or no functional importance](https://www.ncbi.nlm.nih.gov/pubmed/18603430). Therefore, if you want to use an astringent criterion, I'd recoment to use the _ptm_ function **reg.scan()**, which scans only for experimentally documented regulatory PTM sites. Thus, using this function with our model protein P01009, it turns out than only one,  among the fifteen sites previously reported, is known to be functionally relevant.

```{r}
reg <- reg.scan('P01009')
reg[which(grepl('-p', reg$modification)),]
```

