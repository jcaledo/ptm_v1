"0","dir.MM <- function(data, unit_S = 'mM', unit_v = 'au', plot = TRUE){"
"0",""
"0","  ## -------------------- Removing incomplete data -------------------- ##"
"0","  data <- data[complete.cases(data), ]"
"0",""
"0","  ## --------------------- Estimating the seed ------------------------ ##"
"0","  t <- ecb(data, plot = FALSE)"
"0","  K <- t$fitted_parameters[1]"
"0","  V <- t$fitted_parameters[2]"
"0","  seed = list(Km = K, Vm = V)"
"0",""
"0","  ## ---------------------- Fitting the curve ------------------------- ##"
"0","  names(data) <- c('S', 'v')"
"0","  model <- nls(data$v ~ (Vm * data$S)/(Km + data$S), data =  data, start = seed )"
"0",""
"0","  ## --------------------- Computing parameters ----------------------- ##"
"0","  Km <- round(summary(model)$coefficient[1,1], 3)"
"0","  sd_Km <- round(summary(model)$coefficient[1,2], 3)"
"0",""
"0","  Vm <- round(summary(model)$coefficient[2,1], 3)"
"0","  sd_Vm <- summary(model)$coefficient[2,2]"
"0",""
"0","  ## -------------------- Fitted velocity values ---------------------- ##"
"0","  mm.eq <- function(x) {(Vm * x)/(Km + x)}"
"0","  data$fitted_v <- mm.eq(data$S)"
"0",""
"0","  ## --------------- Plotting the transformed variables --------------- ##"
"0","  if (plot){"
"0","    parameters <- paste('Km: ', Km, '     Vm: ', Vm, sep = """")"
"0","    plot(data$S, data$v,"
"0","         xlab = paste(""[S] ("", unit_S, "")"", sep = """"),"
"0","         ylab = paste(""v ("", unit_v, "")"", sep = """"),"
"0","         main = parameters)"
"0",""
"0","    x <- seq(from = 0, to = max(data$S), by = max(data$S)/1000)"
"0","    y <- mm.eq(x)"
"0","    points(x, y, ty = 'l')"
"0",""
"0","  }"
"0","  "
"0","  ## -------------------------- Output ------------------------------- ##"
"0","  KmVm <- c(Km, Vm)"
"0","  names(KmVm) <- c(""Km"", ""Vm"")"
"0",""
"0","  output <- list(KmVm, data)"
"0","  names(output) <- c('parameters', 'data')"
"0",""
"0","  return(output)"
"0","}"
