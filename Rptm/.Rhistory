names(dy) <- names(y)
dymin <- min(y, na.rm = TRUE)
dymax <- max(y, na.rm = TRUE)
dylim <- c(ymin - 0.1*(dymax - dymin), ymax + 0.1*(dymax - dymin))
i <- which(!is.na(dy))
plot(x[i], dy, type = 'l', xlab = 'Residue Number', ylab = "", ylim = dylim)
mtext(text = dylab, side = 2, line = 2)
if (exists.ptm){
if (nrow(ptmScan) >= 1) {
for (i in 1:nrow(ptmScan)){
t <- ptmScan$n[i]
points(t, dy[which(names(dy) == t)], pch = 19,
cex = 0.55*ptmScan$multi[i], col = ptmScan$col[i])
}
}
}
points(coils$respdb, rep(dymin - 0.07*(dymax - dymin), nrow(coils)),
pch = 15, col = 'pink', cex = 0.5)
points(helices$respdb, rep(dymin -0.07*(dymax - dymin), nrow(helices)),
pch = 15, col = 'cyan', cex = 0.5)
points(strands$respdb, rep(dymin -0.07*(dymax - dymin), nrow(strands)),
pch = 15, col = 'magenta', cex = 0.5)
}
par(mar = olmar) # restore par to its default value
par(mfrow = olmfrow)
output <- "Work done."
attr(output, "uniprot") <- up_id
if (exists.pdb){
attr(output, "pdb") <- pdb_id
attr(output, "chain") <- pdb_chain
} else {
attr(output, "pdb") <- "No pdb found for this protein"
}
return(output)
}
for (i in 36:100){
print(i)
a <- Sys.time()
h$test[i] <- ptm.plot(h$prot_id[i],
property = 'acc',
ptm = 'reg')
b <- Sys.time()
h$time[i] <- b-a
closeAllConnections()
}
for (i in 37:100){
print(i)
a <- Sys.time()
h$test[i] <- ptm.plot(h$prot_id[i],
property = 'acc',
ptm = 'reg')
b <- Sys.time()
h$time[i] <- b-a
closeAllConnections()
}
for (i in 44:100){
print(i)
a <- Sys.time()
h$test[i] <- ptm.plot(h$prot_id[i],
property = 'acc',
ptm = 'reg')
b <- Sys.time()
h$time[i] <- b-a
closeAllConnections()
}
?shannon
<<<<<<< HEAD
library(ptm)
?ptm.plot
# setwd('/Users/juancarlosaledo/Dropbox/Investigacion/R_ptm/ptm_bis/ptm/htdocs/Rmd')
# setwd('/Users/JCA/Dropbox/Investigacion/R_ptm/ptm_bis/ptm/htdocs/Rmd')
setwd('/Users/JCA/ptm_outdropbox/ptm/htdocs/Rmd')
library(knitr); library(RWordPress)
## -------- Testing single page or single set of pages
page <- "./ptmplot/ptmplot.Rmd"
title <- "ptm.plot"
options(WordpressLogin = c(jcaledo = 'Pau3%3linG25041966'),
WordpressURL = 'https://metositeptm.com/xmlrpc.php')
knit2wp(page,
title,
publish = FALSE,
action = "newPage") # action = either "newPost" or "newPage"
?search.go
knitr::opts_chunk$set(echo = TRUE)
library(ptm)
library(knitr)
sites <- meto.search(highthroughput.group = FALSE,
bodyguard.group = FALSE,
regulatory.group = TRUE)
ids <- unique(sites$prot_id)
bs <- background.go(ids)
kable(head(bs))
?meto.search
View(sites)
gsites <- meto.search(highthroughput.group = FALSE,
bodyguard.group = FALSE,
regulatory.group = TRUE,
gain.activity = 1)
View(gsites)
gids <- unique(gsites$prot_id)
?hdfisher.go
enrichement <- hdfisher.go(target = gids,
background = gs,
query = "calcium")
enrichement <- hdfisher.go(target = gids,
background = bs,
query = "calcium")
View(enrichement)
enrichment[[1]]
enrichment <- enrichement
enrichemnt[[1]]
enrichment[[1]]
enrichment[[1]]
enrichment[[2]]
depletion   <- hdfisher.go(target = gids,
background = bs,
query = "DNA",
analysis = "depletion")
depletion[[2]]
depletion   <- hdfisher.go(target = gids,
background = bs,
query = "RNA",
analysis = "depletion")
depletion[[2]]
depletion   <- hdfisher.go(target = gids,
background = bs,
query = "RNA",
analysis = "depletion")
depletion[[1]]
depletion[[2]]
depletion   <- hdfisher.go(target = gids,
background = bs,
query = "DNA",
analysis = "depletion")
depletion[[1]]
depletion[[2]]
enrichment   <- hdfisher.go(target = gids,
background = bs,
query = "DNA",
analysis = "enrichment")
enrichment[[1]]
enrichment[[2]]
depletion   <- hdfisher.go(target = gids,
background = bs,
query = "DNA",
analysis = "depletion")
depletion[[1]]
depletion[[2]]
rm(list = ls())
# setwd('/Users/juancarlosaledo/Dropbox/Investigacion/R_ptm/ptm_bis/ptm/htdocs/Rmd')
# setwd('/Users/JCA/Dropbox/Investigacion/R_ptm/ptm_bis/ptm/htdocs/Rmd')
setwd('/Users/JCA/ptm_outdropbox/ptm/htdocs/Rmd')
library(knitr); library(RWordPress)
page <- "./go/hdfisher.Rmd"
title <- "hdfisher.go()"
options(WordpressLogin = c(jcaledo = 'Pau3%3linG25041966'),
WordpressURL = 'https://metositeptm.com/xmlrpc.php')
knit2wp(page,
title,
publish = FALSE,
action = "newPost") # action = either "newPost" or "newPage"
page <- "./go/hdfisher.Rmd"
title <- "gogo"
options(WordpressLogin = c(jcaledo = 'Pau3%3linG25041966'),
WordpressURL = 'https://metositeptm.com/xmlrpc.php')
knit2wp(page,
title,
publish = FALSE,
action = "newPost") # action = either "newPost" or "newPage"
page <- "./go/gogo.Rmd"
title <- "gogo"
options(WordpressLogin = c(jcaledo = 'Pau3%3linG25041966'),
WordpressURL = 'https://metositeptm.com/xmlrpc.php')
knit2wp(page,
title,
publish = FALSE,
action = "newPost") # action = either "newPost" or "newPage"
options(WordpressLogin = c(jcaledo = 'Pau3%3linG25041966'),
WordpressURL = 'https://metositeptm.com/xmlrpc.php')
knit2wp(page,
title,
publish = FALSE,
action = "newPage") # action = either "newPost" or "newPage"
View(gsites)
load("/Users/JCA/Downloads/dataset.Rdata")
View(data)
?gorilla
View(bs)
sites <- meto.search(highthroughput.group = FALSE,
bodyguard.group = FALSE,
regulatory.group = TRUE)
bs <- unique(sites$prot_id)
getwd()
sites <- meto.search(highthroughput.group = FALSE,
bodyguard.group = FALSE,
regulatory.group = TRUE)
bs <- unique(sites$prot_id)
for (i in 1:length(bs)){
cat(bs[i], "\n",
file = "./fichero_de_texto_temporal_background.txt",
append = TRUE)
}
gsites <- meto.search(highthroughput.group = FALSE,
bodyguard.group = FALSE,
regulatory.group = TRUE,
gain.activity = 1)
target <- unique(gsites$prot_id)
for (i in 1:length(target)){
cat(target[i], "\n",
file = "./fichero_de_texto_temporal_target.txt",
append = TRUE)
}
gori <- gorilla(target = "./fichero_de_texto_temporal_target.txt",
background = "./fichero_de_texto_temporal_background.txt",
mode = "hg",
db = 'proc')
gori <- gorilla(target = "./fichero_de_texto_temporal_target.txt",
background = "./fichero_de_texto_temporal_background.txt",
mode = "hg",
db = 'proc',
spe = 'Homo sapiens')
bs[2]
bs
target
sites <- meto.search(highthroughput.group = FALSE,
bodyguard.group = FALSE,
regulatory.group = TRUE)
bs <- unique(sites$prot_id)
for (i in 1:length(bs)){
cat(paste(bs[i], "\n", sep = ""),
file = "./fichero_de_texto_temporal_background.txt",
append = TRUE)
}
sites <- meto.search(highthroughput.group = FALSE,
bodyguard.group = FALSE,
regulatory.group = TRUE)
bs <- unique(sites$prot_id)
for (i in 1:length(bs)){
cat(trimws(paste(bs[i], "\n", sep = "")),
file = "./fichero_de_texto_temporal_background.txt",
append = TRUE)
}
sites <- meto.search(highthroughput.group = FALSE,
bodyguard.group = FALSE,
regulatory.group = TRUE)
bs <- unique(sites$prot_id)
for (i in 1:length(bs)){
cat(paste(bs[i], "\n", sep = ""),
file = "./fichero_de_texto_temporal_background.txt",
append = TRUE)
}
gsites <- meto.search(highthroughput.group = FALSE,
bodyguard.group = FALSE,
regulatory.group = TRUE,
gain.activity = 1)
target <- unique(gsites$prot_id)
for (i in 1:length(target)){
cat(paste(target[i], "\n", sep = ""),
file = "./fichero_de_texto_temporal_target.txt",
append = TRUE)
}
?meto.search
rm(data, sites, bs)
sites <- meto.search(organism = 'Homo sapiens',
oxidant = 'hydrogen peroxide')
View(sites)
bs <- unique(sites$prot_id)
for (i in 1:length(bs)){
cat(paste(bs[i], "\n", sep = ""),
file = "./fichero_de_texto_temporal_background.txt",
append = TRUE)
}
View(sites)
table(sites$met_vivo_vitro)
vivo <- sites[which(sites$met_vivo_vitro == "vivo"), ]
target <- unique(vivo$prot_id)
for (i in 1:length(target)){
cat(paste(target[i], "\n", sep = ""),
file = "./fichero_de_texto_temporal_target.txt",
append = TRUE)
}
gori <- gorilla(target = "./fichero_de_texto_temporal_target.txt",
background = "./fichero_de_texto_temporal_background.txt",
mode = "hg",
db = 'proc',
spe = 'Homo sapiens')
View(gori)
?gorilla
kable(gori)
gori
kable(gori)
View(gori)
file.remove('fichero_de_texto_temporal_target.txt', 'fichero_de_texto_temporal_bacground.txt')
file.remove('fichero_de_texto_temporal_target.txt', 'fichero_de_texto_temporal_background.txt')
page <- "./go/gogo.Rmd"
title <- "gogo"
options(WordpressLogin = c(jcaledo = 'Pau3%3linG25041966'),
WordpressURL = 'https://metositeptm.com/xmlrpc.php')
knit2wp(page,
title,
publish = FALSE,
action = "newPage") # action = either "newPost" or "newPage"
View(gori)
kable(gori[, 1:9])
options(WordpressLogin = c(jcaledo = 'Pau3%3linG25041966'),
WordpressURL = 'https://metositeptm.com/xmlrpc.php')
knit2wp(page,
title,
publish = FALSE,
action = "newPage") # action = either "newPost" or "newPage"
?gorilla
View(vivo)
View(sites)
rm(list = ls())
sites <- meto.search(organism = 'Homo sapiens',
oxidant = 'hydrogen peroxide')
View(sites)
vivo <- sites$prot_id[which(sites$met_vivo_vitro == "vivo")]
vitro <- sites$prot_id[which(sites$met_vivo_vitro == "vitro")]
sites <- meto.search(organism = 'Homo sapiens',
oxidant = 'hydrogen peroxide')
vivo <- unique(sites$prot_id[which(sites$met_vivo_vitro == "vivo")])
vitro <- unique(sites$prot_id[which(sites$met_vivo_vitro == "vitro")])
P <- c(vivo, vitro)
?net.go
sites <- meto.search(organism = 'Homo sapiens',
oxidant = 'hydrogen peroxide')
P <- unique(sites$prot_id[which(sites$met_vivo_vitro == "vivo")])
rm(vivo, vitro)
sites <- meto.search(organism = 'Homo sapiens',
oxidant = 'hydrogen peroxide')
P <- unique(sites$prot_id[which(sites$met_vivo_vitro == "vitro")])
sites <- meto.search(organism = 'Homo sapiens',
oxidant = 'hydrogen peroxide')
P <- unique(sites$prot_id[which(sites$met_vivo_vitro == "vivo")])
i <- Sys.time()
network <- net.go(P[1:100], threshold = 0.2)
f <- Sys.time()
f-i
network[[1]]
Jaccard <- network[[1]]
Jaccard[1:10, 1:10]
Adjacency <- network[[2]]
Adjacency[1:10, 1:10]
nodes <- network[[3]]
nodes[1:10]
edges <- network[[4]]
edges[1:10]
View(edges)
edges <- network[[4]]
head(edges)
G <- igraph::graph_from_data_frame(d = edges,
vertices = nodes,
directed = FALSE)
plot(G,
vertex.label = NA,
edge.color = "black",
vertex.size = 0.5 + (degree(G))^(1/5),
layout = layout_components(G)
)
plot(G,
vertex.label = NA,
edge.color = "black",
vertex.size = 0.5 + (igraph::degree(G))^(1/5),
layout = layout_components(G)
)
G <- igraph::graph_from_data_frame(d = edges,
vertices = nodes,
directed = FALSE)
plot(G,
vertex.label = NA,
edge.color = "black",
vertex.size = 0.5 + (igraph::degree(G))^(1/5),
layout = igraph::layout_components(G)
)
edges <- network[[4]]
nrow(edges)
head(edges)
G <- igraph::graph_from_data_frame(d = edges,
vertices = network[[3]],
directed = FALSE)
plot(G,
vertex.label = NA,
edge.color = "black",
vertex.size = 0.5 + (igraph::degree(G))^(1/5),
layout = igraph::layout_components(G)
)
G <- igraph::graph_from_data_frame(d = edges,
vertices = network[[3]],
directed = FALSE)
plot(G,
vertex.label = NA,
edge.color = "black",
vertex.size = 0.5 + (igraph::degree(G))^(1/5),
layout = igraph::layout_components(G)
)
rm(list = ls())
# setwd('/Users/juancarlosaledo/Dropbox/Investigacion/R_ptm/ptm_bis/ptm/htdocs/Rmd')
# setwd('/Users/JCA/Dropbox/Investigacion/R_ptm/ptm_bis/ptm/htdocs/Rmd')
setwd('/Users/JCA/ptm_outdropbox/ptm/htdocs/Rmd')
page <- "./go/gogo.Rmd"
title <- "gogo"
options(WordpressLogin = c(jcaledo = 'Pau3%3linG25041966'),
WordpressURL = 'https://metositeptm.com/xmlrpc.php')
knit2wp(page,
title,
publish = FALSE,
action = "newPage") # action = either "newPost" or "newPage"
G <- igraph::graph_from_data_frame(d = edges,
vertices = network[[3]],
directed = FALSE)
plot(G,
vertex.label = NA,
edge.color = "black",
vertex.size = 0.5 + (igraph::degree(G))^(1/5),
layout = igraph::layout_components(G)
)
A <- Jaccard
str(A)
is.matrix(A)
threshold = 0.5
A[A >= threshold] <- 1
A[A < threshold] <- 0
diag(A) <- 0
A[is.na(A)] <- 0
A <- A + t(A)
## ------------------------- Network ------------------------------- ##
g <- igraph::graph_from_adjacency_matrix(A, mode = "undirected")
edges.df <- igraph::get.edgelist(g, names=TRUE)
View(edges.df)
edges <- edges.df
G <- igraph::graph_from_data_frame(d = edges,
vertices = network[[3]],
directed = FALSE)
plot(G,
vertex.label = NA,
edge.color = "black",
vertex.size = 0.5 + (igraph::degree(G))^(1/5),
layout = igraph::layout_components(G)
)
View(Jaccard)
setwd("/Users/JCA/Dropbox/Investigacion/Colaboraciones/Paco_Canton")
load("metposmat3.rda")
load("metposhum3.rda")
View(Metposhum)
View(Metposmat)
View(Metposhum)
View(Metposhum)
hsa <- unique(Metposhum$seqname)
ath <- unique(Metposmat$seqname)
View(Metposhum)
#Metposmat <- Metposmat[which(nchar(Metposmat$positive) == 21), ]
positive1 <- env.matrices(Metposmat$positive)[[2]]
#Metposmat <- Metposmat[which(nchar(Metposmat$positive) == 21), ]
positive1 <- ptm::env.matrices(Metposmat$positive)[[2]]
View(positive1)
View(Metposhum)
View(positive1)
positive2 <- env.matrices(Metposhum$positive)[[2]]
positive2 <- ptm::env.matrices(Metposhum$positive)[[2]]
View(positive1)
View(positive2)
positive1 <- positive1[,-11]
positive2 <- positive2[,-11]
View(positive2)
View(positive1)
Z <- env.Ztest(pos = positive1, ctr = positive2, alpha = 0.001)
Z <- ptm::env.Ztest(pos = positive1, ctr = positive2, alpha = 0.001)
Zm <- Z[[1]]
View(Zm)
over <- head(Z[[2]])
under <- head(Z[[3]])
View(over)
View(Zm)
View(over)
View(Zm)
View(under)
View(over)
View(over)
View(under)
env.plot(Z[[1]], aa= 'K', pValue = 0.001)
ptm::env.plot(Z[[1]], aa= 'K', pValue = 0.001)
View(under)
?env.Ztest
ZZ <- ptm::env.Ztest(pos = positive1, ctr = positive2, alpha = 0.05)
zzover <- ZZ[[2]]
View(zzover)
zzunder <- ZZ[[3]]
View(zzunder)
ZZ <- ptm::env.Ztest(pos = positive1, ctr = positive2, alpha = 0.001)
ZZ <- ptm::env.Ztest(pos = positive1, ctr = positive2, alpha = 0.001)
zzover <- ZZ[[2]]
zzunder <- ZZ[[3]]
View(zzover)
View(zzover)
View(Metposhum)
Z <- ptm::env.Ztest(pos = positive1, ctr = positive2, alpha = 0.001)
Zm <- Z[[1]]
# over <- head(Z[[2]])
# under <- head(Z[[3]])
over <- Z[[2]]
under <- Z[[3]]
ptm::env.plot(Z[[1]], aa= 'K', pValue = 0.001)
View(under)
ptm::env.plot(Z[[1]], aa= 'P', pValue = 0.001)
ptm::env.plot(Z[[1]], aa= 'Q', pValue = 0.001)
ptm::env.plot(Z[[1]], aa= 'S', pValue = 0.001)
ptm::env.plot(Z[[1]], aa= 'E', pValue = 0.001)
View(over)
ptm::env.plot(Z[[1]], aa= 'D', pValue = 0.001)
ptm::env.plot(Z[[1]], aa= 'N', pValue = 0.001)
ptm::env.plot(Z[[1]], aa= 'Y', pValue = 0.001)
